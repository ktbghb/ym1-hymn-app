<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>영미의 찬송가</title>
    
    <!-- 홈 화면 아이콘과 전체 화면 설정을 위한 코드 -->
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="icon" href="icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link href="https://fonts.googleapis.comcom/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: 'Noto Sans KR', sans-serif;
            font-size: clamp(14px, 4vw, 18px);
        }
        .playing { 
            background-color: #e9d5ff; /* Light Purple */
            color: #581c87; /* Dark Purple */
            font-weight: bold;
        }
        /* 스크롤바 디자인 */
        #playlist::-webkit-scrollbar { width: 8px; }
        #playlist::-webkit-scrollbar-track { background: #f1f1f1; }
        #playlist::-webkit-scrollbar-thumb { background: #d8b4fe; border-radius: 4px; }
        #playlist::-webkit-scrollbar-thumb:hover { background: #c084fc; }

        /* 반응형 글자 크기를 위한 사용자 정의 클래스 */
        .font-header { font-size: clamp(1.75rem, 7vw, 2.5rem); }
        .font-search { font-size: clamp(1rem, 4vw, 1.25rem); }
        .font-current-song { font-size: clamp(1.25rem, 5vw, 1.875rem); }
        .font-playlist { font-size: clamp(1.125rem, 4.5vw, 1.5rem); }

        /* 배경 그라데이션 애니메이션 */
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .animated-gradient {
            background: linear-gradient(-45deg, #a855f7, #ec4899, #f97316, #eab308);
            background-size: 400% 400%;
            animation: gradient-animation 15s ease infinite;
        }
    </style>
</head>
<body class="animated-gradient">
    <!-- 스마트폰 화면 높이 문제 해결 및 데스크톱 크기 확대 -->
    <div class="w-full min-h-screen flex flex-col lg:items-center lg:justify-center">
        <div class="w-full h-full flex flex-col bg-white/80 backdrop-blur-lg lg:max-w-2xl lg:h-[95vh] lg:my-8 lg:rounded-2xl lg:shadow-2xl">
            <!-- 헤더 부분: 크기 고정 -->
            <header class="text-purple-900 p-6 flex items-center justify-center space-x-4 flex-shrink-0">
                <img src="header-image1.jpg" alt="Header Image" class="w-16 h-16 rounded-full border-2 border-purple-300">
                <h1 class="font-header font-bold">영미의 찬송가</h1>
            </header>
            
            <!-- 검색 및 플레이어 부분: 크기 고정 -->
            <div class="p-6 flex-shrink-0">
                <!-- 검색창 크기 확대 -->
                <div class="relative mb-6">
                    <span class="material-icons absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-2xl">search</span>
                    <input type="text" id="search-input" placeholder="찬송가 검색 (번호 또는 제목)" class="font-search w-full p-4 pl-14 bg-white/50 text-gray-800 placeholder-gray-500 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 transition">
                </div>
                
                <div class="bg-gray-100 rounded-lg p-4 text-center mb-6">
                    <p class="text-gray-500 text-base">현재 재생 중</p>
                    <h2 id="current-song-title" class="font-current-song font-bold text-gray-900 truncate">선택된 곡 없음</h2>
                </div>
                <!-- 오디오 플레이어 크기 확대 -->
                <audio id="audio-player" class="w-full" controls></audio>
            </div>

            <!-- 찬송가 목록: 남은 공간을 모두 차지하고 스크롤되도록 수정 -->
            <div id="playlist" class="px-6 pb-6 flex-grow overflow-y-auto text-gray-800"></div>
        </div>
    </div>

    <!-- 악보 표시를 위한 모달 창 -->
    <div id="sheet-music-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-lg p-4 max-w-4xl max-h-full overflow-auto relative">
            <button id="close-modal-btn" class="absolute top-2 right-2 text-gray-500 hover:text-black">
                <span class="material-icons text-4xl">close</span>
            </button>
            <img id="sheet-music-image" src="" alt="악보" class="w-full h-auto">
            <!-- 악보 로딩 실패 시 표시될 메시지 -->
            <p id="sheet-music-error" class="hidden text-red-500 text-center p-8 text-xl">악보 이미지를 불러올 수 없습니다.<br>파일이 저장소에 있는지, 이름이 올바른지 확인해주세요 (예: 1.JPG).</p>
        </div>
    </div>


    <script>
        // 645장 찬송가 전체 제목 목록
        const hymnTitles = [
            "1장 만복의 근원 하나님", "2장 찬양 성부 성자 성령", "3장 성부 성자와 성령", "4장 성부 성자와 성령",
            "5장 이 천지간 만물들아", "6장 목소리 높여서", "7장 성부 성자 성령", "8장 거룩 거룩 거룩 전능하신 주님", 
            "9장 하늘에 가득 찬 영광의 하나님", "10장 전능왕 오셔서", "11장 홀로 한 분 하나님께", "12장 다 함께 주를 경배하세", 
            "13장 영원한 하늘나라", "14장 주 우리 하나님", "15장 하나님의 크신 사랑", "16장 은혜로신 하나님 우리 주 하나님", 
            "17장 사랑의 하나님", "18장 성도들아 찬양하자", "19장 찬송하는 소리 있어", "20장 큰 영광 중에 계신 주",
            "21장 다 찬양하여라", "22장 만유의 주 앞에", "23장 만 입이 내게 있으면", "24장 왕 되신 주", 
            "25장 면류관 벗어서", "26장 구세주를 아는 이들", "27장 빛나고 높은 보좌와", "28장 복의 근원 강림하사", 
            "29장 성도여 다 함께", "30장 전능하고 놀라우신", "31장 찬양하라 복되신 구세주 예수", "32장 만유의 주재", 
            "33장 영광스런 주를 보라", "34장 참 놀랍도다 주 크신 이름", "35장 큰 영화로신 주", "36장 주 예수 이름 높이어", 
            "37장 주 예수 이름 높이어", "38장 예수 우리 왕이여", "39장 주 은혜를 받으려", "40장 찬송으로 보답할 수 없는",
            "41장 내 영혼아 주 찬양하여라", "42장 거룩한 주님께", "43장 즐겁게 안식할 날", "44장 지난 이레 동안에", 
            "45장 거룩한 주의 날", "46장 이 날은 주님 정하신", "47장 하늘이 푸르고", "48장 거룩하신 주 하나님", 
            "49장 하나님이 언약하신 그대로",  "50장 내게 있는 모든 것을" , "51장 주님 주신 거룩한 날", "52장 거룩하신 나의 하나님", 
            "53장 성전을 떠나기 전", "54장 주여 복을 구하오니", "55장 주 이름으로 모였던", "56장 우리의 주여", 
            "57장 오늘 주신 말씀에", "58장 지난밤에 보호하사", "59장 하나님 아버지 어둔 밤이 지나", 
            "60장 영혼의 햇빛 예수님", "61장 우리가 기다리던", "62장 고요히 머리 숙여", "63장 주가 세상을 다스리니", 
            "64장 기뻐하며 경배하세", "65장 내 영혼아 찬양하라", "66장 다 감사드리세", "67장 영광의 왕께 다 경배하며", 
            "68장 오 하나님 우리의 창조주시니", "69장 온 천하 만물 우러러", "70장 피난처 있으니", "71장 예부터 도움 되시고", 
            "72장 만왕의 왕 앞에 나오라", "73장 내 눈을 들어 두루 살피니", "74장 오 만세 반석이신", "75장 주여 우리 무리를",
            "76장 창조의 주 아버지께", "77장 거룩하신 하나님", "78장 저 높고 푸른 하늘과", "79장 주 하나님 지으신 모든 세계", 
            "80장 천지에 있는 이름 중", "81장 주는 귀한 보배", "82장 성부의 어린 양이", "83장 나의 맘에 근심 구름", 
            "84장 온 세상이 캄캄하여서", "85장 구주를 생각만 해도", "86장 내가 늘 의지하는 예수", "87장 내 주님 입으신 그 옷은", 
            "88장 내 진정 사모하는", "89장 샤론의 꽃 예수", "90장 주 예수 내가 알기 전", "91장 슬픈 마음 있는 사람", 
            "92장 위에 계신 나의 친구", "93장 예수는 나의 힘이요", "94장 주 예수보다 더 귀한 것은 없네", "95장 나의 기쁨 나의 소망 되시며",
            "96장 예수님은 누구신가", "97장 정혼한 처녀에게", "98장 예수님 오소서", "99장 주님 앞에 떨며 서서", "100장 미리암과 여인들이",
            "101장 이새의 뿌리에서", "102장 영원한 문아 열려라", "103장 우리 주님 예수께", "104장 곧 오소서 임마누엘", 
            "105장 오랫동안 기다리던", "106장 아기 예수 나셨네", "107장 거룩한 밤 복된 이 밤", "108장 그 어린 주 예수", 
            "109장 고요한 밤 거룩한 밤", "110장 고요하고 거룩한 밤", "111장 귀중한 보배합을", "112장 그 맑고 환한 밤중에", 
            "113장 저 아기 잠이 들었네", "114장 그 어린 주 예수", "115장 기쁘다 구주 오셨네", "116장 동방에서 박사들", 
            "117장 만백성 기뻐하여라", "118장 영광 나라 천사들아", "119장 옛날 임금 다윗성에", "120장 오 베들레헴 작은 골",
            "121장 우리 구주 나신 날", "122장 참 반가운 성도여", "123장 저 들 밖에 한밤중에", "124장 양 지키는 목자여", 
            "125장 천사들의 노래가", "126장 천사 찬송하기를", "127장 그 고요하고 쓸쓸한", "128장 거룩하신 우리 주님", 
            "129장 마리아는 아기를", "130장 찬란한 주의 영광은", "131장 다 나와 찬송드리세", "132장 주의 영광 빛나니", 
            "133장 하나님의 말씀으로", "134장 나 어느 날 꿈속을 헤매며", "135장 어저께나 오늘이나", "136장 가나의 혼인 잔치", 
            "137장 하나님의 아들이", "138장 햇빛을 받는 곳마다", "139장 오 영원한 내 주 예수", "140장 왕 되신 우리 주께",
            "141장 호산나 호산나", "142장 시온에 오시는 주", "143장 웬말인가 날 위하여", "144장 예수 나를 위하여", 
            "145장 오 거룩하신 주님", "146장 저 멀리 푸른 언덕에", "147장 거기 너 있었는가", "148장 영화로운 주 예수의", 
            "149장 주 달려 죽은 십자가", "150장 갈보리산 위에", "151장 만왕의 왕 내 주께서", "152장 귀하신 예수", 
            "153장 가시 면류관", "154장 생명의 주여 면류관", "155장 십자가 지고", "156장 머리에 가시관 붉은 피 흐르는",  
            "157장 겟세마네 동산에서 최후 기도", "158장 서쪽 하늘 붉은 노을", "159장 기뻐 찬송하세", "160장 무덤에 머물러", 
            "161장 할렐루야 우리 예수", "162장 부활하신 구세주", "163장 할렐루야 할렐루야", "164장 예수 부활했으니", 
            "165장 주님께 영광", "166장 싸움은 모두 끝나고", "167장 즐겁도다 이 날", "168장 하늘에 찬송이 들리던 그 날", 
            "169장 사망의 권세가", "170장 내 주님은 살아계셔", "171장 하나님의 독생자", "172장 사망을 이긴 주", 
            "173장 다 함께 찬송 부르자", "174장 대속하신 구주께서", "175장 신랑 되신 예수께서", "176장 주 어느때 다시 오실는지",  
            "177장 오랫동안 고대하던", "178장 주 예수 믿는 자여", "179장 주 예수의 강림이", "180장 하나님의 나팔 소리", 
            "181장 부활 승천하신 주께서", "182장 강물같이 흐르는 기쁨", "183장 빈 들에 마른 풀같이", "184장 불길 같은 주 성령", 
            "185장 이 기쁜 소식을", "186장 영화로신 주 성령", "187장 비둘기같이 온유한", "188장 무한하신 주 성령", 
            "189장 진실하신 주 성령", "190장 성령이여 강림하사", "191장 내가 매일 기쁘게", "192장 임하소서 임하소서", 
            "193장 성령의 봄바람 불어오니", "194장 저 하늘 거룩하신 주여", "195장 성령이여 우리 찬송 부를때", "196장 성령의 은사를", 
            "197장 은혜가 풍성한 하나님은", "198장 주 예수 해변서", "199장 나의 사랑하는 책", "200장 달고 오묘한 그 말씀",
            "201장 참 사람 되신 말씀", "202장 하나님 아버지 주신 책은", "203장 하나님의 말씀은", "204장 주의 말씀 듣고서", 
            "205장 주 예수 크신 사랑", "206장 주님의 귀한 말씀은", "207장 귀하신 주님 계신 곳", "208장 내 주의 나라와", 
            "209장 이 세상 풍파 심하고", "210장 시온성과 같은 교회", "211장 값비싼 향유를 주께 드린", "212장 겸손히 주를 섬길 때", 
            "213장 나의 생명 드리니", "214장 나 주의 도움 받고자", "215장 내 죄 속해 주신 주께", "216장 성자의 귀한 몸", 
            "217장 하나님이 말씀하시기를", "218장 네 맘과 정성을 다하여서", "219장 주 하나님의 사랑은", "220장 사랑하는 주님 앞에",
            "221장 주 믿는 형제들", "222장 우리 다시 만날 때까지", "223장 하나님은 우리들의", "224장 정한 물로 우리 죄를", 
            "225장 실로암 샘물가에 핀", "226장 성령으로 세례받아", "227장 주 앞에 성찬 받기 위하여", "228장 오 나의 주님 친히 뵈오니", 
            "229장 아무 흠도 없고", "230장 우리의 참되신 구주시니", "231장 우리 다 같이 무릎 꿇고서", "232장 유월절 때가 이르러", 
            "233장 자비로 그 몸 찢기시고", "234장 구주 예수 그리스도", "235장 보아라 즐거운 우리 집", "236장 우리 모든 수고 끝나", 
            "237장 저 건너편 강 언덕에", "238장 해 지는 저편", "239장 저 뵈는 본향 집", "240장 주가 맡긴 모든 역사",
            "241장 아름다운 본향", "242장 황무지가 장미꽃같이", "243장 저 요단강 건너편에", "244장 구원받은 천국의 성도들", 
            "245장 저 좋은 낙원 이르니", "246장 나 가나안 땅 귀한 성에", "247장 보아라 저 하늘에", "248장 언약의 주 하나님", 
            "249장 주 사랑하는 자 다 찬송할 때에", "250장 구주의 십자가 보혈로", "251장 놀랍다 주님의 큰 은혜", "252장 나의 죄를 씻기는", 
            "253장 그 자비하신 주님", "254장 내 주의 보혈은", "255장 너희 죄 흉악하나", "256장 나의 죄 모두 지신 주", 
            "257장 마음에 가득한 의심을 깨치고", "258장 샘물과 같은 보혈은", "259장 예수 십자가에 흘린 피로써", "260장 우리를 죄에서 구하시려",
            "261장 이 세상의 모든 죄를", "262장 날 구원하신 예수님", "263장 이 세상 험하고", "264장 정결하게 하는 샘이", 
            "265장 주 십자가를 지심으로", "266장 주의 피로 이룬 샘물", "267장 주의 확실한 약속의 말씀 듣고", "268장 죄에서 자유를 얻게 함은",
            "269장 그 참혹한 십자가에", "270장 변찮는 주님의 사랑과", "271장 나와 같은 죄인 위해", "272장 고통의 멍에 벗으려고", 
            "273장 나 주를 멀리 떠났다", "274장 나 행한 것 죄뿐이니", "275장 날마다 주와 멀어져", "276장 아버지여 이 죄인을", 
            "277장 양 떼를 떠나서", "278장 여러 해 동안 주 떠나", "279장 인애하신 구세주여", "280장 천부여 의지 없어서",
            "281장 요나처럼 순종 않고", "282장 큰 죄에 빠진 날 위해", "283장 나 속죄함을 받은 후", "284장 오랫동안 모든 죄 가운데 빠져", 
            "285장 주의 말씀 받은 그 날", "286장 주 예수님 내 맘에 오사", "287장 예수 앞에 나오면", "288장 예수를 나의 구주 삼고", 
            "289장 주 예수 내 맘에 들어와", "290장 우리는 주님을 늘 배반하나", "291장 외롭게 사는 이 그 누군가", "292장 주 없이 살 수 없네", 
            "293장 주의 사랑 비칠 때에", "294장 하나님은 외아들을", "295장 큰 죄에 빠진 나를", "296장 죄인 구원하시려고", 
            "297장 양 아흔아홉 마리는", "298장 속죄하신 구세주를", "299장 하나님 사랑은", "300장 내 맘이 낙심되며",
            "301장 지금까지 지내온 것", "302장 내 주 하나님 넓고 큰 은혜는", "303장 날 위하여 십자가의", "304장 그 크신 하나님의 사랑", 
            "305장 나 같은 죄인 살리신", "306장 죽을 죄인 살려주신", "307장 소리 없이 보슬보슬", "308장 내 평생 살아온 길", 
            "309장 목마른 내 영혼", "310장 아 하나님의 은혜로", "311장 내 너를 위하여", "312장 너 하나님께 이끌리어", 
            "313장 내 임금 예수 내 주여", "314장 내 구주 예수를 더욱 사랑", "315장 내 주 되신 주를 참 사랑하고", "316장 주여 나의 생명", 
            "317장 내 주 예수 주신 은혜", "318장 순교자의 흘린 피가", "319장 말씀으로 이 세상을", "320장 나의 죄를 정케 하사",
            "321장 날 대속하신 예수께", "322장 세상의 헛된 신을 버리고", "323장 부름받아 나선 이 몸", "324장 예수 나를 오라 하네",  
            "325장 예수가 함께 계시니", "326장 내 죄를 회개하고", "327장 주님 주실 화평", "328장 너 주의 사람아", 
            "329장 주 날 불러 이르소서", "330장 어두운 밤 쉬 되리니", "331장 영광을 받으신 만유의 주여", "332장 우리는 부지런한", 
            "333장 충성하라 죽도록", "334장 위대하신 주를", "335장 크고 놀라운 평화가", "336장 환난과 핍박 중에도", 
            "337장 내 모든 시험 무거운 짐을", "338장 내 주를 가까이 하게 함은", "339장 내 주님 지신 십자가", "340장 어지러운 세상 중에",
            "341장 십자가를 내가 지고", "342장 너 시험을 당해", "343장 시험받을 때에", "344장 믿음으로 가리라", 
            "345장 캄캄한 밤 사나운 바람 불 때", "346장 주 예수 우리 구하려", "347장 허락하신 새 땅에", "348장 마귀들과 싸울지라", 
            "349장 나는 예수 따라가는", "350장 우리들의 싸울 것은", "351장 믿는 사람들은 주의 군사니", "352장 십자가 군병들아", 
            "353장 십자가 군병 되어서", "354장 주를 앙모하는 자", "355장 다 같이 일어나", "356장 주 예수 이름 소리 높여", 
            "357장 주 믿는 사람 일어나", "358장 주의 진리 위해 십자가 군기", "359장 천성을 향해 가는 성도들아", "360장 행군 나팔 소리에",
            "361장 기도하는 이 시간", "362장 주여 복을 주시기를", "363장 내가 깊은 곳에서", "364장 내 기도하는 그 시간", 
            "365장 마음속에 근심 있는 사람", "366장 어두운 내 눈 밝히사", "367장 인내하게 하소서 주여 우리를", "368장 주 예수여 은혜를", 
            "369장 죄짐 맡은 우리 구주", "370장 주 안에 있는 나에게", "371장 구주여 광풍이 불어", "372장 그 누가 나의 괴롬 알며", 
            "373장 고요한 바다로", "374장 나의 믿음 약할 때", "375장 나는 갈 길 모르니", "376장 나그네와 같은 내가", 
            "377장 전능하신 주 하나님", "378장 내 선한 목자", "379장 내 갈 길 멀고 밤은 깊은데", "380장 나의 생명 되신 주",
            "381장 나 캄캄한 밤 죄의 길에", "382장 너 근심 걱정 말아라", "383장 눈을 들어 산을 보니", "384장 나의 갈 길 다 가도록", 
            "385장 못 박혀 죽으신", "386장 만세 반석 열린 곳에", "387장 멀리 멀리 갔더니", "388장 비바람이 칠 때와", 
            "389장 내게로 오라 하신 주님의", "390장 예수가 거느리시니", "391장 오 놀라운 구세주", "392장 주여 어린 사슴이", 
            "393장 오 신실하신 주", "394장 이 세상의 친구들", "395장 자비하신 예수여", "396장 우리 주님 밤새워", 
            "397장 주 사랑 안에 살면", "398장 어둠의 권세에서", "399장 어린 양들아 두려워 말아라", "400장 험한 시험 물속에서",
            "401장 주의 곁에 있을 때", "402장 나의 반석 나의 방패", "403장 영원하신 주님의", "404장 바다에 놀이 일 때에", 
            "405장 주의 친절한 팔에 안기세", "406장 곤한 내 영혼 편히 쉴 곳과", "407장 구주와 함께 나 죽었으니", "408장 나 어느 곳에 있든지", 
            "409장 나의 기쁨은 사랑의 주님께", "410장 내 맘에 한 노래 있어", "411장 아 내 맘속에", "412장 내 영혼의 그윽히 깊은 데서", 
            "413장 내 평생에 가는 길", "414장 이 세상은 요란하나", "415장 십자가 그늘 아래", "416장 너희 근심 걱정을", 
            "417장 주 예수 넓은 품에", "418장 기쁠 때나 슬플 때나", "419장 주 날개 밑 내가 편안히 쉬네", "420장 너 성결키 위해",
            "421장 내가 예수 믿고서", "422장 거룩하게 하소서", "423장 먹보다도 더 검은", "424장 아버지여 나의 맘을", 
            "425장 주님의 뜻을 이루소서", "426장 이 죄인을 완전케 하시옵고", "427장 맘 가난한 사람", "428장 내 영혼에 햇빛 비치니", 
            "429장 세상 모든 풍파 너를 흔들어", "430장 주와 같이 길 가는 것", "431장 주 안에 기쁨 있네", "432장 큰 물결이 설레는 어둔 바다", 
            "433장 귀하신 주여 날 붙드사", "434장 귀한 친구 내게 계시니", "435장 나의 영원하신 기업", "436장 나 이제 주님의 새 생명 얻은 몸", 
            "437장 하늘 보좌 떠나서", "438장 내 영혼이 은총 입어", "439장 십자가로 가까이", "440장 어디든지 예수 나를 이끌면",
            "441장 은혜 구한 내게 은혜의 주님", "442장 저 장미꽃 위에 이슬", "443장 아침 햇살 비칠 때", "444장 겟세마네 동산에서", 
            "445장 태산을 넘어 험곡에 가도", "446장 주 음성 외에는", "447장 이 세상 끝날까지", "448장 주님 가신 길을 따라", 
            "449장 예수 따라가며", "450장 내 평생 소원 이것뿐", "451장 예수 영광 버리사", "452장 내 모든 소원 기도의 제목", 
            "453장 예수 더 알기 원하네", "454장 주와 같이 되기를", "455장 주님의 마음을 본받는 자", "456장 거친 세상에서 실패하거든", 
            "457장 겟세마네 동산의", "458장 너희 마음에 슬픔이 가득할 떄", "459장 누가 주를 따라", "460장 뜻 없이 무릎 꿇는",
            "461장 십자가를 질 수 있나", "462장 생명 진리 은혜 되신", "463장 신자 되기 원합니다", "464장 믿음의 새 빛을", 
            "465장 주 믿는 나 남 위해", "466장 죽기까지 사랑하신 주", "467장 높으신 주께서 낮아지심은", "468장 큰 사랑의 새 계명을", 
            "469장 내 주 하나님", "470장 나의 몸이 상하여", "471장 주여 나의 병든 몸을", "472장 네 병든 손 내밀라고", 
            "473장 괴로움과 고통을", "474장 의원되신 예수님의", "475장 인류는 하나 되게", "476장 꽃이 피고 새가 우는", 
            "477장 하나님이 창조하신", "478장 참 아름다워라", "479장 괴로운 인생길 가는 몸이", "480장 천국에서 만나보자",
            "481장 때 저물어서 날이 어두니", "482장 참 즐거운 노래를", "483장 구름 같은 이 세상", "484장 내 맘의 주여 소망되소서", 
            "485장 세월이 흘러가는데", "486장 이 세상에 근심된 일이 많고", "487장 어두움 후에 빛이 오며", "488장 이 몸의 소망 무언가", 
            "489장 저 요단강 건너편에 찬란하게", "490장 주여 지난 밤 내 꿈에", "491장 저 높은 곳을 향하여", "492장 잠시 세상에 내가 살면서", 
            "493장 하늘가는 밝은 길이", "494장 만세 반석 열리니", "495장 익은 곡식 거둘 자가", "496장 새벽부터 우리", 
            "497장 주 예수 넓은 사랑", "498장 저 죽어가는 자 다 구원하고", "499장 흑암에 사는 백성들을 보라", "500장 물위에 생명줄 던지어라",
            "501장 너 시온아 이 소식 전파하라", "502장 빛의 사자들이여", "503장 세상 모두 사랑 없어", "504장 주님의 명령 전할 사자여", 
            "505장 온 세상 위하여", "506장 땅 끝까지 복음을", "507장 저 북방 얼음산과", "508장 우리가 지금은 나그네 되어도", 
            "509장 기쁜 일이 있어 천국 종 치네", "510장 하나님의 진리 등대", "511장 예수 말씀 하시기를", "512장 천성길을 버리고", 
            "513장 헛된 욕망 길을 가며", "514장 먼동 튼다 일어나라", "515장 눈을 들어 하늘 보라", "516장 옳은 길 따르라 의의 길을", 
            "517장 가난한 자 돌보시며", "518장 기쁜 소리 들리니", "519장 구주께서 부르되", "520장 듣는 사람마다 복음 전하여",
            "521장 구원으로 인도하는", "522장 웬일인가 내 형제여", "523장 어둔 죄악 길에서", "524장 갈 길을 밝히 보이시니", 
            "525장 돌아와 돌아와", "526장 목마른 자들아", "527장 어서 돌아오오", "528장 예수가 우리를 부르는 소리", 
            "529장 온유한 주님의 음성", "530장 주께서 문에 오셔서", "531장 자비한 주께서 부르시네", "532장 주께로 한 걸음씩", 
            "533장 우리주 십자가", "534장 주님 찾아오셨네", "535장 주 예수 대문 밖에", "536장 죄짐에 눌린 사람은", 
            "537장 형제여 지체 말라", "538장 죄짐을 지고서 곤하거든", "539장 너 예수께 조용히 나가", "540장 주의 음성을 내가 들으니",
            "541장 꽃이 피는 봄날에만", "542장 구주 예수 의지함이", "543장 어려운 일 당할 때", "544장 울어도 못하네", 
            "545장 이 눈에 아무 증거 아니 뵈어도", "546장 주님 약속하신 말씀 위에서", "547장 나 같은 죄인까지도", "548장 날 구속하신", 
            "549장 내 주여 뜻대로", "550장 시온의 영광이 빛나는 아침", "551장 오늘까지 복과 은혜", "552장 아침 해가 돋을 때", 
            "553장 새해 아침 환히 밝았네", "554장 종소리 크게 울려라", "555장 우리 주님 모신 가정", "556장 날마다 주님을 의지하는", 
            "557장 에덴의 동산처럼", "558장 미더워라 주의 가정", "559장 사철에 봄바람 불어잇고", "560장 주의 발자취를 따름이",
            "561장 예수님의 사랑은", "562장 예루살렘 아이들", "563장 예수 사랑하심을", "564장 예수께서 오실 때에", 
            "565장 예수께로 가면", "566장 사랑의 하나님 귀하신 이름은", "567장 다정하신 목자 예수", "568장 하나님은 나의 목자시니", 
            "569장 선한 목자 되신 우리 주", "570장 주는 나를 기르시는 목자", "571장 역사 속에 보냄 받아", "572장 바다같이 넓은 은혜", 
            "573장 말씀에 순종하여", "574장 가슴마다 파도친다", "575장 주님께 귀한 것 드려", "576장 하나님의 뜻을 따라", 
            "577장 낳으시고 길러주신", "578장 언제나 바라봐도", "579장 어머니의 넓은 사랑", "580장 삼천리 반도 금수강산",
            "581장 주 하나님 이 나라를 지켜주시고", "582장 어둔 밤 마음에 잠겨", "583장 이 민족에 복음을", "584장 우리나라 지켜주신", 
            "585장 내 주는 강한 성이요", "586장 어느 민족 누구게나", "587장 감사하는 성도여", "588장 공중 나는 새를 보라", 
            "589장 넓은 들에 익은 곡식", "590장 논밭에 오곡백과", "591장 저 밭에 농부 나가", "592장 산마다 불이 탄다 고운 단풍에", 
            "593장 아름다운 하늘과", "594장 감사하세 찬양하세", "595장 나 맡은 본분은", "596장 영광은 주님 홀로", 
            "597장 이전에 주님을 내가 몰라", "598장 천지 주관하는 주님", "599장 우리의 기도 들어주시옵소서", "600장 교회의 참된 터는",
            "601장 하나님이 정하시고", "602장 성부님께 빕니다", "603장 태초에 하나님이", "604장 완전한 사랑", 
            "605장 오늘 모여 찬송함은", "606장 해보다 더 밝은 저 천국", "607장 내 본향 가는 길", "608장 후일에 생명 그칠 때", 
            "609장 이 세상 살 때에", "610장 고생과 수고가 다 지난 후", "611장 주님 오라 부르시어", "612장 이 땅에서 주를 위해", 
            "613장 사랑의 주 하나님", "614장 얼마나 아프셨나", "615장 그 큰 일을 행하신", "616장 주를 경배하리", 
            "617장 주님을 찬양합니다", "618장 나 주님을 찬양하리라", "619장 놀라운 그 이름", "620장 여기에 모인 우리",
            "621장 찬양하라 내 영혼아", "622장 거룩한 밤", "623장 주님의 시간에", "624장 우리 모두 찬양해", 
            "625장 거룩 거룩 거룩한 하나님", "626장 만민들아 다 경배하라", "627장 할렐루야 할렐루야 다 함께", "628장 아멘 아멘 아멘 영광과 존귀를", 
            "629장 거룩 거룩 거룩", "630장 진리와 생명 되신 주", "631장 우리 기도를", "632장 주여 주여 우리를", 
            "633장 나의 하나님 받으소서", "634장 모든 것이 주께로부터", "635장 하늘에 계신(주기도문)", "636장 하늘에 계신(주기도문)", 
            "637장 주님 우리의 마음을 여시어", "638장 주 너를 지키시고", "639장 주 함께하소서", "640장 아멘",
            "641장 아멘", "642장 아멘", "643장 아멘", "644장 아멘", "645장 아멘"
        ];

        const songs = [];
        const baseUrl = "https://raw.githubusercontent.com/ktbghb/ym-hymn-app/main/";

        // 1장부터 645장까지 자동으로 목록을 만듭니다.
        for (let i = 1; i <= 645; i++) {
            songs.push({
                // hymnTitles 배열에서 제목을 가져옵니다. (i-1인 이유는 배열이 0부터 시작하기 때문)
                title: hymnTitles[i-1] || `${i}장`, // 만약 제목이 없으면 'i장'으로 표시
                url: `${baseUrl}${i}.mp3`,
                sheetUrl: `${baseUrl}${i}.JPG` // 악보 URL 확장자를 대문자 JPG로 수정
            });
        }
        
        const audioPlayer = document.getElementById('audio-player');
        const playlistElement = document.getElementById('playlist');
        const currentSongTitleElement = document.getElementById('current-song-title');
        const sheetMusicModal = document.getElementById('sheet-music-modal');
        const sheetMusicImage = document.getElementById('sheet-music-image');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const sheetMusicError = document.getElementById('sheet-music-error');

        let currentPlayingItem = null;

        // 노래 재생이 끝나면 초기화하는 기능 수정
        audioPlayer.addEventListener('ended', () => {
            currentSongTitleElement.textContent = "선택된 곡 없음";
            if (currentPlayingItem) {
                currentPlayingItem.classList.remove('playing');
                currentPlayingItem.querySelector('i').textContent = 'play_circle_outline';
                currentPlayingItem = null;
            }
            // 악보 모달도 닫기
            sheetMusicModal.classList.add('hidden');
        });

        audioPlayer.addEventListener('error', () => {
            console.error(`오류: '${currentSongTitleElement.textContent}' 파일을 불러올 수 없습니다. GitHub에 파일이 있는지, 이름이 올른지 확인해주세요.`);
            currentSongTitleElement.textContent = "파일 재생 실패!";
            if (currentPlayingItem) {
                currentPlayingItem.classList.add('bg-red-100', 'text-red-700');
                currentPlayingItem.querySelector('i').textContent = 'error_outline';
            }
        });

        function renderPlaylist(songList) {
            playlistElement.innerHTML = '';
            songList.forEach(song => {
                const originalIndex = songs.indexOf(song);
                const songItem = document.createElement('div');
                songItem.className = 'font-playlist p-3 font-bold rounded-lg cursor-pointer hover:bg-purple-100 transition-all flex items-center justify-between';
                songItem.innerHTML = `<span>${song.title}</span><i class="material-icons text-gray-400">play_circle_outline</i>`;
                songItem.addEventListener('click', () => playSong(originalIndex, songItem));
                playlistElement.appendChild(songItem);
            });
        }

        function playSong(index, songItem) {
            const song = songs[index];
            currentSongTitleElement.textContent = song.title; 
            
            // 악보 이미지 상태 초기화 및 로드 이벤트 핸들러 설정
            sheetMusicImage.style.display = 'block';
            sheetMusicError.classList.add('hidden');

            sheetMusicImage.onload = () => {
                sheetMusicImage.style.display = 'block';
                sheetMusicError.classList.add('hidden');
            };
            sheetMusicImage.onerror = () => {
                sheetMusicImage.style.display = 'none';
                sheetMusicError.classList.remove('hidden');
            };

            // 악보 이미지 설정 및 모달 표시
            sheetMusicImage.src = song.sheetUrl;
            sheetMusicModal.classList.remove('hidden');

            if (audioPlayer.src !== song.url) {
                audioPlayer.src = song.url;
            }
            audioPlayer.play().then(() => {
                if (currentPlayingItem) {
                    currentPlayingItem.classList.remove('playing', 'bg-red-100', 'text-red-700');
                    currentPlayingItem.querySelector('i').textContent = 'play_circle_outline';
                }
                songItem.classList.add('playing');
                songItem.querySelector('i').textContent = 'pause_circle_outline';
                currentPlayingItem = songItem;
            }).catch(e => console.error("재생 오류:", e));
        }

        // 모달 닫기 버튼 이벤트
        closeModalBtn.addEventListener('click', () => {
            sheetMusicModal.classList.add('hidden');
        });

        // 검색 기능 추가
        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('input', (event) => {
            const searchTerm = event.target.value.trim();
            
            if (!searchTerm) {
                renderPlaylist(songs); 
                return;
            }

            const filteredSongs = songs.filter(song => {
                const title = song.title.toLowerCase();
                const term = searchTerm.toLowerCase();
                
                const titleMatch = title.includes(term);
                const numberPart = song.title.split('장')[0];
                const numberMatch = numberPart.startsWith(term);

                return titleMatch || numberMatch;
            });

            renderPlaylist(filteredSongs);
        });


        // 페이지가 로드되면 전체 목록을 보여줍니다.
        renderPlaylist(songs);
    </script>
</body>
</html>
